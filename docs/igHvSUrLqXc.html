<!DOCTYPE html>

<! — 
Copyright 2018 Google LLC

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

  https://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
 — >

<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="author" content="//google.com">
  <meta name="description" content="Chrome Dev Summit">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>igHvSUrLqXc</title>
  <link rel="stylesheet" href="css/main.css">
</head>

<body>

<iframe id="youtube" src="https://www.youtube.com/embed/igHvSUrLqXc?enablejsapi=1"></iframe>

<div id="container">

<div id="options">
  <div id="google-translate"></div>
  <div>
    <input type="checkbox" id="videoSticky" checked>
    <label for="videoSticky">Video position sticky</label>
  </div>
  <div>
    <input type="checkbox" id="captionScroll" checked>
    <label for="captionScroll">Keep current caption visible</label>
  </div>
</div>

<section>
<p><span data-start="0" data-end="1.928">[MUSIC PLAYING]</span> </p>
</section>

<section>
<p><span data-start="6.75" data-end="8.26"><span class="speaker">Jason Chase</span>: Good morning, everyone.</span> <span data-start="8.26" data-end="10.29">So I lead a Chrome team whose mission</span> <span data-start="10.29" data-end="12.9">is to help developers better understand and control</span> <span data-start="12.9" data-end="14.59">the web platform.</span> <span data-start="14.59" data-end="16.65">So we've been working on feature policy</span> <span data-start="16.65" data-end="18.66">and reporting API, which we think</span> <span data-start="18.66" data-end="21.784">can really make your lives easier as web developers.</span> <span data-start="21.784" data-end="23.7">Maybe it won't save you from speeding tickets,</span> <span data-start="23.7" data-end="27.762">like Nicole said, but we'll see what we can do.</span> <span data-start="27.762" data-end="29.97">So we know there's many benefits to being on the web.</span> <span data-start="29.97" data-end="34.17">But as a development platform, it's far from perfect.</span> </p>
<p><span data-start="34.17" data-end="35.94">On the Chrome team, we regularly provide</span> <span data-start="35.94" data-end="40.83">web consults to help people address issues with their site.</span> <span data-start="40.83" data-end="44.82">Now, these consults bring together developer relations,</span> <span data-start="44.82" data-end="47.19">engineering, and other folks to help people</span> <span data-start="47.19" data-end="50.34">deep dive into questions or issues with their site.</span> <span data-start="50.34" data-end="52.5">Now, the goal is to provide actual recommendations</span> <span data-start="52.5" data-end="54.51">to improve things.</span> <span data-start="54.51" data-end="58.5">Now, as a result, we've identified common mistakes that</span> <span data-start="58.5" data-end="61.686">happen over and over again.</span> </p>
<p><span data-start="61.686" data-end="63.06">And —  spoiler alert —  performance</span> <span data-start="63.06" data-end="64.79">is a common theme here.</span> <span data-start="64.79" data-end="66.9">And the two big performance problems we see</span> <span data-start="66.9" data-end="69.674">are too much script and too many image bytes</span> <span data-start="69.674" data-end="70.84">being sent over the network.</span> </p>
<p><span data-start="73.95" data-end="76.64">So you know there's a right way to do things.</span> <span data-start="76.64" data-end="78.94">But it's an adventure to find that sometimes.</span> <span data-start="78.94" data-end="81.74">And even if you find the right way, there's bumps.</span> <span data-start="81.74" data-end="83.9">Or you might slip off the path.</span> <span data-start="83.9" data-end="85.7">So as we've seen in other talks, there's</span> <span data-start="85.7" data-end="89.3">a long list of things to keep track of and get right.</span> <span data-start="89.3" data-end="92.015">Now, this is hard enough if you're an expert developer.</span> <span data-start="92.015" data-end="94.265">But imagine you have a dev team with junior developers</span> <span data-start="94.265" data-end="96.31">and you need to keep everyone on the same page.</span> <span data-start="99.4" data-end="101.567">So we need help.</span> <span data-start="101.567" data-end="103.4">What if we could make web development easier</span> <span data-start="103.4" data-end="105.18">with guardrails?</span> <span data-start="105.18" data-end="107.615">So if you imagine guardrails along a path — </span> <span data-start="107.615" data-end="111.5">if you hit a rail, you know you're doing something wrong.</span> </p>
<p><span data-start="111.5" data-end="114.65">And the rails stop you from leaving the path.</span> <span data-start="114.65" data-end="117.84">Now, this isn't necessarily a new idea.</span> <span data-start="117.84" data-end="120.68">But looking at repeated mistakes in our web consults,</span> <span data-start="120.68" data-end="123.75">we're thinking about different ways to apply this.</span> <span data-start="123.75" data-end="127.5">Concretely, how could we help you put guardrails in place</span> <span data-start="127.5" data-end="130.53">for development?</span> <span data-start="130.53" data-end="133.17">So AMP gives us examples — </span> <span data-start="133.17" data-end="135.73">an example of guardrails and web development.</span> <span data-start="135.73" data-end="138.8">AMP gives guarantees you're not going to veer off course</span> <span data-start="138.8" data-end="143.07">by making it nearly impossible to do things wrong.</span> <span data-start="143.07" data-end="146.3">Now, AMP started by providing building blocks, tightly</span> <span data-start="146.3" data-end="150.125">constrained, to ensure great performance in UX.</span> </p>
<p><span data-start="150.125" data-end="152.06">So this is an [INAUDIBLE] approach</span> <span data-start="152.06" data-end="155.78">to carve off good parts of the web platform.</span> <span data-start="155.78" data-end="159.53">Now, not everyone can or wants to use AMP.</span> <span data-start="159.53" data-end="162.41">So learning from AMP, we thought about a more configurable</span> <span data-start="162.41" data-end="163.8">approach.</span> <span data-start="163.8" data-end="166.43">And that's Feature Policy.</span> <span data-start="166.43" data-end="167.84">So we're really excited about it.</span> <span data-start="167.84" data-end="169.423">We think it's going to be a great tool</span> <span data-start="169.423" data-end="171.31">to help guide you towards the well-lit path</span> <span data-start="171.31" data-end="174.71">to web development.</span> <span data-start="174.71" data-end="176.75">Now, with Feature Policy you opt into a set</span> <span data-start="176.75" data-end="181.07">of policies for the browser to enforce throughout your site.</span> <span data-start="181.07" data-end="184.82">These policies restrict which features the site can access — </span> <span data-start="184.82" data-end="187.49">or modify the browser's default behavior for certain features.</span> </p>
<p><span data-start="190.4" data-end="194.61">So let's talk through some of the common problems we've seen.</span> <span data-start="194.61" data-end="197.38">So images often have extra quality or metadata</span> <span data-start="197.38" data-end="201.49">that take up space but isn't required.</span> <span data-start="201.49" data-end="203.2">Now, as we've seen in other talks,</span> <span data-start="203.2" data-end="205.39">again, there's many tools to optimize images.</span> <span data-start="205.39" data-end="208">But you have to remember to use them.</span> <span data-start="208" data-end="212.47">Or you have to integrate them into your build pipeline.</span> </p>
<p><span data-start="212.47" data-end="214.63">Now ideally, your page should never</span> <span data-start="214.63" data-end="217.33">serve images that are larger than the version that's</span> <span data-start="217.33" data-end="219.25">rendered on-screen.</span> <span data-start="219.25" data-end="222.04">Anything larger just results in wasted bytes</span> <span data-start="222.04" data-end="225.23">and slows down page load time.</span> <span data-start="225.23" data-end="228.35">So a common example might be sending a desktop-size hero</span> <span data-start="228.35" data-end="230.12">image to a mobile device.</span> <span data-start="232.86" data-end="235.24">We've designed policies to catch common mistakes</span> <span data-start="235.24" data-end="239.15">of un-optimized or oversized images.</span> </p>
<p><span data-start="239.15" data-end="241.09">So we researched the impact that we</span> <span data-start="241.09" data-end="242.995">think these policies can have on 10,000</span> <span data-start="242.995" data-end="245.84">of the most popular sites.</span> <span data-start="245.84" data-end="248.06">Our analysis shows that 10% of sites</span> <span data-start="248.06" data-end="251.28">can save over 500 kilobytes on average.</span> <span data-start="251.28" data-end="255.87">Now, that can reduce load time by up to 10 seconds on a 3G</span> <span data-start="255.87" data-end="256.37">network.</span> <span data-start="259.47" data-end="261.529">So let's take a quick look.</span> <span data-start="261.529" data-end="264.5">So this shows the policies being applied to a site.</span> <span data-start="264.5" data-end="268.27">Now on the left, policy for un-optimized images</span> <span data-start="268.27" data-end="269.94">is turned off.</span> <span data-start="269.94" data-end="273.03">And you can see, the images load at normal.</span> </p>
<p><span data-start="273.03" data-end="276.18">On the right, we've turned on the policy.</span> <span data-start="276.18" data-end="278.86">And it's blocked one of the images.</span> <span data-start="278.86" data-end="283.92">So we compute a compression ratio of bytes to pixels.</span> <span data-start="283.92" data-end="286.83">And if that ratio is greater than 0.5,</span> <span data-start="286.83" data-end="289.63">it will block the image and will show a placeholder.</span> <span data-start="289.63" data-end="291.63">So the idea is to point out the images that</span> <span data-start="291.63" data-end="292.838">need to be corrected.</span> <span data-start="296.05" data-end="299.45">So this site might look familiar.</span> <span data-start="299.45" data-end="302.26">At Google, we're big believers in dog-fooding.</span> <span data-start="302.26" data-end="305.29">So we went and applied all the policies we could to the site.</span> <span data-start="305.29" data-end="308.9">Lo and behold, we found out we made a few mistakes.</span> <span data-start="308.9" data-end="313.31">So we applied a bunch of policies.</span> </p>
<p><span data-start="313.31" data-end="315.79">But it was actually the oversized images policy</span> <span data-start="315.79" data-end="318.97">that caught that we were sending some images that were too big.</span> <span data-start="318.97" data-end="320.736">So oops!</span> <span data-start="320.736" data-end="322.63">It just shows that even the experts,</span> <span data-start="322.63" data-end="326.23">like our developer relations team, can make mistakes.</span> <span data-start="326.23" data-end="328.48">So we really need better tooling to help</span> <span data-start="328.48" data-end="331.54">catch these kind of things.</span> <span data-start="331.54" data-end="336.55">So another common problem is images without explicit sizes.</span> <span data-start="336.55" data-end="340">Now, as we see on the left, this can cause your user experience</span> <span data-start="340" data-end="342.48">to jump around as the browser loads</span> <span data-start="342.48" data-end="345.58">the new images and resizes the page.</span> <span data-start="345.58" data-end="349.27">Now, on the right, we've applied a policy to catch this.</span> <span data-start="349.27" data-end="351.709">So the browser can set these images to a fixed size.</span> </p>
<p><span data-start="351.709" data-end="353.5">And it'll keep your user experience stable.</span> <span data-start="358.06" data-end="359.91">So how does this all work?</span> <span data-start="359.91" data-end="361.9">Policies, like I said before, are a contract</span> <span data-start="361.9" data-end="364.93">between developer and browser.</span> <span data-start="364.93" data-end="366.79">We use them to inform the browser</span> <span data-start="366.79" data-end="369.31">about our intent for our site.</span> </p>
<p><span data-start="369.31" data-end="372.54">It's a set of rules for how each page should behave.</span> <span data-start="372.54" data-end="374.54">Now, the browser helps keep us honest</span> <span data-start="374.54" data-end="376.84">when our page tries to veer off the path,</span> <span data-start="376.84" data-end="382.33">by validating that it's behaving according to its stated rules.</span> </p>
<p><span data-start="382.33" data-end="385.65">So if a page or embedded third-party content</span> <span data-start="385.65" data-end="387.67">attempts to violate any of the rules,</span> <span data-start="387.67" data-end="390.1">the browser will identify or block the behavior.</span> <span data-start="390.1" data-end="392.91">And in some cases, it may override the behavior</span> <span data-start="392.91" data-end="396.42">to write a better user experience.</span> <span data-start="396.42" data-end="399.2">All right, let's take a look at how you configure policies.</span> <span data-start="399.2" data-end="403.09">Now, each policy refers to a single feature.</span> <span data-start="403.09" data-end="404.96">And then it defines a list of origins that</span> <span data-start="404.96" data-end="408.39">are allowed to use the feature.</span> </p>
<p><span data-start="408.39" data-end="410.22">Now, with each page response, you</span> <span data-start="410.22" data-end="413.874">can add this Feature Policy HTTP header.</span> <span data-start="413.874" data-end="415.29">So in this example here, this will</span> <span data-start="415.29" data-end="417.87">catch all oversized images.</span> <span data-start="417.87" data-end="421.97">And this is the one that saved our bacon on the CDS site.</span> <span data-start="421.97" data-end="423.99">Now here, the "none" keyword means</span> <span data-start="423.99" data-end="426.96">that no origin is allowed to use the feature</span> <span data-start="426.96" data-end="430.89">of oversized images, disabling it entirely for your site.</span> <span data-start="433.64" data-end="435.19">Now, looking at that example, you</span> <span data-start="435.19" data-end="438.92">might wonder why we would say, oversized images are a feature.</span> <span data-start="438.92" data-end="440.295">Now, we have policies for helping</span> <span data-start="440.295" data-end="443.54">you enforce best practices, to ensure good performance</span> <span data-start="443.54" data-end="445.52">and user experience.</span> </p>
<p><span data-start="445.52" data-end="447.44">And the way these often work is, we'll</span> <span data-start="447.44" data-end="450.08">define a known bad practice as a feature.</span> <span data-start="450.08" data-end="453.83">And then you use the policy to prevent it.</span> <span data-start="453.83" data-end="457.14">Now, we do this for web-compatible reasons.</span> <span data-start="457.14" data-end="459.14">We don't want to go ahead and break the internet</span> <span data-start="459.14" data-end="462.44">by all the sudden turning off oversized images for everyone.</span> <span data-start="462.44" data-end="465.33">So we'll allow that behavior by default.</span> <span data-start="465.33" data-end="467.03">And then you opt in to turn it off.</span> <span data-start="470.39" data-end="472.06">Now, this header applies a policy</span> <span data-start="472.06" data-end="476.05">that catches any images that are not optimized.</span> </p>
<p><span data-start="476.05" data-end="478.14">Now here, we're making an explicit exception</span> <span data-start="478.14" data-end="480.36">for our photo CDN.</span> <span data-start="480.36" data-end="483.9">Now in this case, it might be because our users expect really</span> <span data-start="483.9" data-end="486.18">high-detailed glossy pictures.</span> <span data-start="486.18" data-end="489.9">And those don't compress well.</span> <span data-start="489.9" data-end="493.5">Now, in this case, there's only one origin listed.</span> </p>
<p><span data-start="493.5" data-end="495.48">And all origins will not be allowed.</span> <span data-start="499.48" data-end="503.75">So here's an example that puts them all together.</span> <span data-start="503.75" data-end="507.04">So first, we have a policy that ensures every image has</span> <span data-start="507.04" data-end="508.73">explicit dimensions.</span> <span data-start="508.73" data-end="512.2">So we saw this earlier, preventing your user experience</span> <span data-start="512.2" data-end="514.27">from jumping around.</span> <span data-start="514.27" data-end="517.33">Now second, we have a policy to selectively enable</span> <span data-start="517.33" data-end="519.75">the geolocation feature.</span> </p>
<p><span data-start="519.75" data-end="521.83">So now, we're applying this to our own origin</span> <span data-start="521.83" data-end="524.73">and to our trusted maps provider.</span> <span data-start="524.73" data-end="527.37">The "self" keyword here means the origin</span> <span data-start="527.37" data-end="529.62">of the top-level page.</span> <span data-start="529.62" data-end="532.16">So by combining this with explicit origins,</span> <span data-start="532.16" data-end="536.47">you have full control over who is allowed to use a feature.</span> <span data-start="536.47" data-end="540.89">And then finally, we're allowing any origin to use autoplay.</span> <span data-start="540.89" data-end="543.32">And here, you see an asterisks keyword.</span> <span data-start="543.32" data-end="545.66">That means essentially everyone.</span> </p>
<p><span data-start="545.66" data-end="549.17">So by default, Chrome will only allow autoplay</span> <span data-start="549.17" data-end="550.76">on same-origin iframes.</span> <span data-start="550.76" data-end="553.214">With this policy, we can allow cross-origin iframes</span> <span data-start="553.214" data-end="553.88">to play as well.</span> <span data-start="557.35" data-end="559.96">So in that last example, we saw features</span> <span data-start="559.96" data-end="561.75">in the more traditional sense — </span> <span data-start="561.75" data-end="563.92">well-known APIs that are exposed to the web,</span> <span data-start="563.92" data-end="569.01">like geolocation, camera, full-screen, autoplay.</span> <span data-start="569.01" data-end="573.23">So before, we saw policies about enforcing best practices.</span> <span data-start="573.23" data-end="576.07">So now, we have policies that give you granular control</span> <span data-start="576.07" data-end="578.2">over the features you use.</span> <span data-start="578.2" data-end="580.21">So we've probably all seen this example.</span> <span data-start="580.21" data-end="580.955">You go to a site.</span> <span data-start="580.955" data-end="582.83">And before you interact with the site at all,</span> <span data-start="582.83" data-end="586.48">you get a pop-up to use location or microphone</span> <span data-start="586.48" data-end="588.41">or something like that.</span> </p>
<p><span data-start="588.41" data-end="590.86">So with Feature Policy, you can lock</span> <span data-start="590.86" data-end="594.37">this down to either prevent the use of the feature at all</span> <span data-start="594.37" data-end="597.715">or really just dole it out to specific origins you trust.</span> <span data-start="602.87" data-end="605.92">So we've talked through some examples of an HTTP header.</span> <span data-start="605.92" data-end="608.56">You can also use an Allow attribute</span> <span data-start="608.56" data-end="611.62">to control Feature Policy on iframes.</span> <span data-start="611.62" data-end="613.37">So now, why might you want to do this?</span> <span data-start="613.37" data-end="617.08">Well, as we talked about, you can be really selective.</span> <span data-start="617.08" data-end="620.44">So maybe you have one frame on your site that shows a map.</span> <span data-start="620.44" data-end="622.81">You could use the Allow attribute</span> <span data-start="622.81" data-end="625.36">to grant the geolocation usage to that frame</span> <span data-start="625.36" data-end="626.44">and on no other frames.</span> <span data-start="629.02" data-end="632.72">Now, in the example we see here, this Allow attribute</span> <span data-start="632.72" data-end="635.551">is changing the default for the AutoPlay feature.</span> <span data-start="635.551" data-end="637.3">Well, you'll notice, if you go to generate</span> <span data-start="637.3" data-end="640">and embed on YouTube, they're already</span> <span data-start="640" data-end="641.31">using this in production today.</span> </p>
<p><span data-start="645.57" data-end="647.15">So we've seen a lot of flexibility</span> <span data-start="647.15" data-end="650.184">in how you can configure Feature Policy.</span> <span data-start="650.184" data-end="652.1">So we built in some rules to make sure they're</span> <span data-start="652.1" data-end="654.14">being applied correctly.</span> <span data-start="654.14" data-end="657.5">So Malte in the keynote talked rather enthusiastically</span> <span data-start="657.5" data-end="660.59">about not using sync-xhr HR.</span> <span data-start="660.59" data-end="662.21">And yes, we do have a policy for that.</span> <span data-start="662.21" data-end="665.19">And AMP is using that in production.</span> <span data-start="665.19" data-end="671.6">So the way the rules apply is, first, policies are inherited.</span> <span data-start="671.6" data-end="673.19">So scripts will inherit the policy</span> <span data-start="673.19" data-end="675">of their containing frame.</span> </p>
<p><span data-start="675" data-end="678.05">So this means that, for your top-level scripts,</span> <span data-start="678.05" data-end="681.66">they'll inherit the policies of the main document.</span> <span data-start="681.66" data-end="685.28">So this means you can apply the policies at the top.</span> <span data-start="685.28" data-end="687.86">And they cascade down to all nested sub-frames.</span> <span data-start="687.86" data-end="689.69">So in AMP's case, they can set the policy</span> <span data-start="689.69" data-end="692.18">to disable sync-xhr and know that it</span> <span data-start="692.18" data-end="694.46">will be applied to all sub-frames,</span> <span data-start="694.46" data-end="696.59">regardless of how far they might be nested.</span> <span data-start="700.23" data-end="702.49">And this applies to the iframe attribute — </span> </p>
<p><span data-start="702.49" data-end="704.226">Allow attribute as well.</span> <span data-start="704.226" data-end="705.6">So if you have an Allow attribute</span> <span data-start="705.6" data-end="708.57">and you have a header, the stricter of the two policies</span> <span data-start="708.57" data-end="710.43">wins.</span> <span data-start="710.43" data-end="715.95">Now, on the other hand, we have this one-way toggle.</span> <span data-start="715.95" data-end="718.77">So disabling a feature turns it off permanently.</span> <span data-start="718.77" data-end="720.51">So that means, again, in AMP's case,</span> <span data-start="720.51" data-end="724.21">they've turned off the feature with the sync-xhr policy.</span> <span data-start="724.21" data-end="726.3">And that means no frame, nested or otherwise,</span> <span data-start="726.3" data-end="727.18">can turn it back on.</span> <span data-start="731.62" data-end="734.74">Now, for policy supporting best practices,</span> <span data-start="734.74" data-end="736.6">it might not be feasible for the browser</span> <span data-start="736.6" data-end="740.49">to actually block the bad practice before it appears.</span> <span data-start="740.49" data-end="743.01">It can only detect the problem, in some cases,</span> <span data-start="743.01" data-end="746.446">and then break your page in an obvious way or notify you.</span> </p>
<p><span data-start="746.446" data-end="747.82">The goal, in that case, is really</span> <span data-start="747.82" data-end="750.66">to let you know there's a problem to fix.</span> <span data-start="750.66" data-end="753.87">Now, we saw this in the policy for un-optimized images</span> <span data-start="753.87" data-end="755.58">and oversized images.</span> <span data-start="755.58" data-end="757.92">Now, in other cases, the browser can actually</span> <span data-start="757.92" data-end="761.82">block the bad practice, so your site continues to behave well.</span> <span data-start="761.82" data-end="764.64">The policy front-sized media works this way.</span> <span data-start="764.64" data-end="766.71">So it will apply fixed-size to images</span> <span data-start="766.71" data-end="769.68">to prevent the user experience from jumping around.</span> </p>
<p><span data-start="773.32" data-end="775.51">So we have dev tools in Lighthouse</span> <span data-start="775.51" data-end="778.81">to give you great insight into the behavior of your site.</span> <span data-start="778.81" data-end="783.13">So where does Feature Policy fit into your development workflow?</span> <span data-start="783.13" data-end="786.19">Feature Policy lets you set the policies up-front and then</span> <span data-start="786.19" data-end="788.2">catch problems early during development,</span> <span data-start="788.2" data-end="791.612">before anyone writes a lot of code.</span> <span data-start="791.612" data-end="793.32">Now, you can build policies that defaults</span> <span data-start="793.32" data-end="795.39">for new sites or new pages.</span> <span data-start="795.39" data-end="800.24">And this way, you can enforce standards across your dev team.</span> </p>
<p><span data-start="800.24" data-end="803.64">Policies are served with each page and validated at runtime.</span> <span data-start="803.64" data-end="806.12">So you can choose to turn them on for some users and not</span> <span data-start="806.12" data-end="807.94">others.</span> <span data-start="807.94" data-end="810.25">You can also turn them on for some pages in your site</span> <span data-start="810.25" data-end="812.08">and not others, as you incrementally</span> <span data-start="812.08" data-end="814.63">improve your site, for example.</span> <span data-start="814.63" data-end="817.93">So at a minimum we recommend enabling the policies</span> <span data-start="817.93" data-end="819.85">on your staging server.</span> <span data-start="819.85" data-end="822.64">This can let you catch problems that you</span> <span data-start="822.64" data-end="824.45">didn't see during development.</span> <span data-start="824.45" data-end="828.01">For example, you might have your images come from a content</span> <span data-start="828.01" data-end="829.157">management system.</span> <span data-start="829.157" data-end="831.49">And they're not available as you're developing the site.</span> <span data-start="831.49" data-end="833.031">So this can catch problems with that.</span> <span data-start="835.45" data-end="837.88">In addition to staging, you can also</span> <span data-start="837.88" data-end="839.98">apply policies in production.</span> </p>
<p><span data-start="839.98" data-end="842.11">You can have your dev team, your managers — </span> <span data-start="842.11" data-end="843.46">all the way up to your CEO — </span> <span data-start="843.46" data-end="846.43">use your site with policies enabled, so that you can</span> <span data-start="846.43" data-end="849.46">find real issues in the wild.</span> <span data-start="849.46" data-end="851.83">For regular production users, you likely</span> <span data-start="851.83" data-end="854.53">won't enable the policies if violations</span> <span data-start="854.53" data-end="857.48">will break the user experience.</span> </p>
<p><span data-start="857.48" data-end="860.17">So for example, with the image policies,</span> <span data-start="860.17" data-end="862.759">loading un-optimized images more slowly</span> <span data-start="862.759" data-end="864.55">is probably a better experience than having</span> <span data-start="864.55" data-end="867.13">them missing altogether.</span> <span data-start="867.13" data-end="869.98">You still want to know about all these violations,</span> <span data-start="869.98" data-end="872.58">so you can correct them.</span> <span data-start="872.58" data-end="874.95">So we've designed report-only mode</span> <span data-start="874.95" data-end="878.24">to give you the best of both worlds.</span> <span data-start="878.24" data-end="881.23">So you can configure policies similar to the examples</span> <span data-start="881.23" data-end="882.31">we saw before.</span> <span data-start="882.31" data-end="884.38">But you mark them as report-only.</span> <span data-start="884.38" data-end="887.44">So you see here, internal users — </span> <span data-start="887.44" data-end="889.439">they have the policies enabled.</span> <span data-start="889.439" data-end="890.23">We'll break things.</span> <span data-start="890.23" data-end="893.26">We'll see problems with images that need to get corrected.</span> <span data-start="893.26" data-end="896.77">For production users, we have them in report-only mode.</span> </p>
<p><span data-start="896.77" data-end="899.32">So the production users get the normal experience.</span> <span data-start="899.32" data-end="902">But then you can get reports about what's gone wrong.</span> <span data-start="905.12" data-end="908.87">So speaking of reporting, Feature Policy violations</span> <span data-start="908.87" data-end="910.26">are really just the start.</span> <span data-start="910.26" data-end="912.15">There's lots of other info from the wild</span> <span data-start="912.15" data-end="915.02">that'll be really valuable — </span> <span data-start="915.02" data-end="917.33">for example, browser interventions.</span> <span data-start="917.33" data-end="919.25">Sometimes, a browser needs to intervene</span> <span data-start="919.25" data-end="921.48">to improve the experience for the end-user.</span> <span data-start="921.48" data-end="925.16">So an example of such a intervention</span> <span data-start="925.16" data-end="928.76">is blocking document.write, unlike 2G connections.</span> </p>
<p><span data-start="928.76" data-end="933.437">So there, we've discovered that doing a document.write</span> <span data-start="933.437" data-end="935.02">on a really slow connection can really</span> <span data-start="935.02" data-end="936.74">impair the user experience.</span> <span data-start="936.74" data-end="939.59">So to protect that, we've just blocked it.</span> <span data-start="939.59" data-end="941.06">But that happens in the wild.</span> <span data-start="941.06" data-end="942.919">You don't know about it.</span> <span data-start="942.919" data-end="944.46">You really want to find out about it,</span> <span data-start="944.46" data-end="945.376">so you can correct it.</span> <span data-start="948.27" data-end="949.36">Now, what else?</span> </p>
<p><span data-start="949.36" data-end="950.95">So just taking a look at this, there's</span> <span data-start="950.95" data-end="954.566">lots of things going on in the wild on your site</span> <span data-start="954.566" data-end="957.05">that you'd really love to know about.</span> <span data-start="957.05" data-end="960.28">Not a problem —  some of these are just console messages,</span> <span data-start="960.28" data-end="962.17">which you can't collect.</span> </p>
<p><span data-start="962.17" data-end="964.27">Now, there's other things that have a bespoke API,</span> <span data-start="964.27" data-end="965.23">like window.onerror.</span> <span data-start="965.23" data-end="967.45">So you have to remember to go hook up something</span> <span data-start="967.45" data-end="969.37">there to get some errors.</span> </p>
<p><span data-start="969.37" data-end="971.68">And then there's things like crashes and network errors</span> <span data-start="971.68" data-end="976.41">that just aren't possible to capture from script.</span> <span data-start="976.41" data-end="978.69">So a solution here is reporting API.</span> <span data-start="978.69" data-end="981">This gives you one place to collect all sorts</span> <span data-start="981" data-end="982.29">of information from the wild.</span> </p>
<p><span data-start="982.29" data-end="985.23">It's a one-stop shop.</span> <span data-start="985.23" data-end="987.87">It exposes information that wasn't available before.</span> <span data-start="987.87" data-end="990.81">We've talked about network errors, crashes — </span> <span data-start="990.81" data-end="992.79">now, that's coming soon — </span> <span data-start="992.79" data-end="995.16">Feature Policy violations.</span> <span data-start="995.16" data-end="997.81">Deprecations, interventions, and network errors — </span> <span data-start="997.81" data-end="1002.3">you can get those today with reporting API.</span> <span data-start="1002.3" data-end="1005.38">There's two ways to use reporting.</span> <span data-start="1005.38" data-end="1007.61">We have the reporting observer, which</span> <span data-start="1007.61" data-end="1011.77">lets you collect reports client-side, with a JS API.</span> <span data-start="1011.77" data-end="1013.969">Now, you can filter by report type.</span> </p>
<p><span data-start="1013.969" data-end="1016.01">Here, we've said, we just care about deprecations</span> <span data-start="1016.01" data-end="1018.55">and Feature Policy violations.</span> <span data-start="1018.55" data-end="1022.04">And then you can use a callback to funnel these reports</span> <span data-start="1022.04" data-end="1024.566">to your own analytics provider or however you'd</span> <span data-start="1024.566" data-end="1025.44">like to capture them.</span> <span data-start="1028.16" data-end="1030.68">Now, because it's client-side, the available types</span> <span data-start="1030.68" data-end="1032.089">are limited.</span> <span data-start="1032.089" data-end="1034.46">But the key feature here is it buffers results.</span> <span data-start="1034.46" data-end="1037.22">So you can set up your reporting observer later and still get</span> <span data-start="1037.22" data-end="1039.079">reports that happened earlier in page load.</span> <span data-start="1042.849" data-end="1045.88">So every report has some common fields.</span> <span data-start="1045.88" data-end="1049.2">So we can see here the type of the report and the URL,</span> <span data-start="1049.2" data-end="1051.14">where the report happened.</span> <span data-start="1051.14" data-end="1054.23">And then, for each report type, there's a specific body.</span> <span data-start="1054.23" data-end="1056.37">Now, for Feature Policy violations,</span> <span data-start="1056.37" data-end="1059.002">we see it's telling you the feature that you were using.</span> </p>
<p><span data-start="1059.002" data-end="1061.46">And it tells you where in your code the violation occurred.</span> <span data-start="1064.23" data-end="1066.3">Now, the second way to use reporting</span> <span data-start="1066.3" data-end="1069.36">is with the report-to-response header.</span> <span data-start="1069.36" data-end="1072.77">So this lets you configure out-of-band delivery reports.</span> <span data-start="1072.77" data-end="1075.23">The browser will queue up reports and send them</span> <span data-start="1075.23" data-end="1077.45">to the location of your choosing,</span> <span data-start="1077.45" data-end="1081.12">separate from the execution of your page.</span> <span data-start="1081.12" data-end="1083.45">And so here, you can get all of the report types</span> <span data-start="1083.45" data-end="1084.29">that we saw earlier.</span> <span data-start="1086.96" data-end="1088.55">So you'll see a couple fields here.</span> <span data-start="1088.55" data-end="1089.935">So first, there's Group.</span> <span data-start="1089.935" data-end="1094.6">And that just lets you name this particular set of end points.</span> <span data-start="1094.6" data-end="1097.24">And then you can refer to that group name</span> <span data-start="1097.24" data-end="1100.7">in other parts of your configuration.</span> <span data-start="1100.7" data-end="1105.04">Now, max_age says how long this configuration is valid for.</span> <span data-start="1105.04" data-end="1108.14">After that, we'll throw away this configuration.</span> </p>
<p><span data-start="1108.14" data-end="1111.19">So this lets you know change endpoints over time</span> <span data-start="1111.19" data-end="1113.24">and gradually switch to new ones.</span> <span data-start="1113.24" data-end="1116.17">And finally, endpoints is an array of URLs.</span> <span data-start="1116.17" data-end="1118.45">So you can configure multiple URLs for fallback.</span> <span data-start="1118.45" data-end="1120.55">So if the browser can't reach one endpoint,</span> <span data-start="1120.55" data-end="1121.3">it'll try another.</span> </p>
<p><span data-start="1125.58" data-end="1129.72">And so talking about one place to configure reporting — </span> <span data-start="1129.72" data-end="1132.24">CSP, Content Security Policy, now</span> <span data-start="1132.24" data-end="1134.6">integrates with the reporting API.</span> <span data-start="1134.6" data-end="1136.835">So whereas before, you'd specify a report URI</span> <span data-start="1136.835" data-end="1138.21">and you'd give it an URL to where</span> <span data-start="1138.21" data-end="1141.39">you wanted your reports to go — </span> <span data-start="1141.39" data-end="1144.48">now, you can use the report-to directive.</span> </p>
<p><span data-start="1144.48" data-end="1147.12">And you just point it at one of the endpoints you'd previously</span> <span data-start="1147.12" data-end="1148.004">configured.</span> <span data-start="1148.004" data-end="1149.67">So if we go back to the preview example,</span> <span data-start="1149.67" data-end="1151.2">you'd send a report-to header.</span> <span data-start="1151.2" data-end="1153.61">And you'd define a group called CSP endpoint.</span> <span data-start="1153.61" data-end="1155.774">You can have all the URLs you need there, the age.</span> <span data-start="1155.774" data-end="1157.44">And then you just refer back to it here.</span> <span data-start="1161.16" data-end="1163.99">So where can you use this stuff?</span> <span data-start="1163.99" data-end="1167.58">So both the Feature Policy framework and the reporting API</span> <span data-start="1167.58" data-end="1169.41">are shipped in Chrome.</span> <span data-start="1169.41" data-end="1171.96">Firefox is implementing Feature Policy.</span> <span data-start="1171.96" data-end="1176.07">And Safari has support for the iframe Allow attribute.</span> <span data-start="1176.07" data-end="1178.08">Now, what's really great is you can</span> <span data-start="1178.08" data-end="1180.66">benefit from using these policies now,</span> <span data-start="1180.66" data-end="1184.65">even though there isn't broad support across browsers.</span> </p>
<p><span data-start="1184.65" data-end="1187.19">If you do some of your local testing in Chrome</span> <span data-start="1187.19" data-end="1189.86">with flags enabled, you can apply all these policies</span> <span data-start="1189.86" data-end="1192.765">and catch problems before they reach other environments.</span> <span data-start="1195.56" data-end="1199.245">So I've talked a lot about a few policies,</span> <span data-start="1199.245" data-end="1200.87">walked through the examples, explaining</span> <span data-start="1200.87" data-end="1202.161">why you might want to use them.</span> <span data-start="1202.161" data-end="1203.79">But that's really just the start.</span> <span data-start="1203.79" data-end="1207.99">So here's a list of all the ones we have available today.</span> </p>
<p><span data-start="1207.99" data-end="1209.99">Most of the ones around granular control —  like,</span> <span data-start="1209.99" data-end="1213.152">turning on and off features, like, geolocation,</span> <span data-start="1213.152" data-end="1214.61">microphone —  those kind of things — </span> <span data-start="1214.61" data-end="1215.693">those are already shipped.</span> <span data-start="1215.693" data-end="1216.98">So you can use those now.</span> <span data-start="1216.98" data-end="1220.602">And we saw that with the YouTube example and with AMP.</span> <span data-start="1220.602" data-end="1222.56">And a lot of the best practice policies —  those</span> <span data-start="1222.56" data-end="1223.76">are behind a flag.</span> <span data-start="1223.76" data-end="1225.89">And we're also working on a bunch more.</span> <span data-start="1229.93" data-end="1232.69">Now, seeing that long list, you go, man,</span> <span data-start="1232.69" data-end="1234.382">how am I going to set up policies?</span> </p>
<p><span data-start="1234.382" data-end="1235.84">How am I going to try them all out?</span> <span data-start="1235.84" data-end="1239.27">Well, we have a handy dev tools extension.</span> <span data-start="1239.27" data-end="1242.2">So this lets you really easily toggle a policy on and off</span> <span data-start="1242.2" data-end="1244.17">and see the effect on your page, so you</span> <span data-start="1244.17" data-end="1245.92">don't have to configure the set-up headers</span> <span data-start="1245.92" data-end="1248.88">or modify your code to allow attributes.</span> <span data-start="1248.88" data-end="1250.94">You can just try it and see what'll happen.</span> <span data-start="1250.94" data-end="1253.316">So here, we've seen an example of using the extension</span> <span data-start="1253.316" data-end="1254.815">to turn off the geolocation feature.</span> </p>
<p><span data-start="1257.55" data-end="1261.3">Now, this extension uses a JavaScript API.</span> <span data-start="1261.3" data-end="1263.61">So the advantage there is, you can feature</span> <span data-start="1263.61" data-end="1266.81">detect which policies are even supported.</span> <span data-start="1266.81" data-end="1268.71">And you can go one step further.</span> <span data-start="1268.71" data-end="1270.5">And you can query to see which policies</span> <span data-start="1270.5" data-end="1272.1">are enabled or disabled.</span> <span data-start="1272.1" data-end="1274.4">So this can allow you to code defensively.</span> <span data-start="1274.4" data-end="1277.04">So for example, if you have content that's embedded,</span> <span data-start="1277.04" data-end="1279.46">you can respond differently if you know the features that</span> <span data-start="1279.46" data-end="1280.335">are available to you.</span> <span data-start="1283.08" data-end="1285.61">So we really love to hear if these policies are</span> <span data-start="1285.61" data-end="1287.09">useful for you.</span> <span data-start="1287.09" data-end="1289.75">The ones we're really interested in are somewhere around some</span> <span data-start="1289.75" data-end="1291.88">of the images, and even sync-xhr.</span> <span data-start="1291.88" data-end="1295.3">So we've made it easy for you to, hopefully, copy and paste</span> <span data-start="1295.3" data-end="1296.89">and get a header sent real quick.</span> </p>
<p><span data-start="1296.89" data-end="1298.81">Now, if you have ideas for new policies</span> <span data-start="1298.81" data-end="1300.93">or if you have feedback on the existing ones,</span> <span data-start="1300.93" data-end="1304.18">we'd love to hear from you on our GitHub repo.</span> <span data-start="1304.18" data-end="1307.282">And finally, you can head over to FeaturePolicy.rocks.</span> <span data-start="1307.282" data-end="1309.49">And you'll get more information about Feature Policy,</span> <span data-start="1309.49" data-end="1313.54">about code samples, and live demos.</span> <span data-start="1313.54" data-end="1314.32">Thanks a lot.</span> <span data-start="1314.32" data-end="1315.22">[APPLAUSE]</span> <span data-start="1315.22" data-end="1318.27">[MUSIC PLAYING]</span> </p>
</section>

<! —  div#container ends  — >
</div>

<img alt="The End" id="fin" src="images/fin.jpg">

<script>
/*eslint-disable */
function googleTranslateElementInit() {
  new google.translate.TranslateElement({pageLanguage: 'en',
    layout: google.translate.TranslateElement.InlineLayout.SIMPLE
    }, 'google-translate');
}
/* eslint-enable */
</script>

<script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

<script src="js/main.js"></script>

</body>

</html>
